# 개발환경 설정 가이드

## 필수 설치 프로그램

### 1. Java Development Kit (JDK)
- **버전**: JDK 17 이상
- **설치 방법**:
  - [Adoptium](https://adoptium.net/)에서 OpenJDK 17 다운로드
  - 또는 [Oracle JDK 17](https://www.oracle.com/java/technologies/downloads/#java17) 다운로드
- **환경변수 설정**:
  ```bash
  JAVA_HOME=C:\Program Files\Java\jdk-17
  PATH에 %JAVA_HOME%\bin 추가
  ```
- **설치 확인**:
  ```bash
  java -version
  ```

### 2. Docker Desktop
- **용도**: MariaDB 데이터베이스 실행
- **설치**: [Docker Desktop](https://www.docker.com/products/docker-desktop/)
- **설정**: WSL2 백엔드 사용 권장 (Windows)

### 3. IDE 권장사항
- **IntelliJ IDEA** (권장) 또는 VS Code with Spring Boot Extension
- **VS Code 필수 확장**:
  - Spring Boot Extension Pack
  - Java Extension Pack
  - Gradle for Java

## 프로젝트 설정

### 1단계: 프로젝트 클론
```bash
git clone [repository-url]
cd platform/backend
```

### 2단계: 데이터베이스 설정

#### Docker Compose를 사용한 MariaDB 실행
```bash
# Docker Compose로 MariaDB 실행
docker-compose -f docker-compose/db/docker-compose.yml up -d

# 실행 확인
docker ps | grep mariadb

# 로그 확인
docker logs groupware-mariadb
```

#### 데이터베이스 정보
- **호스트**: localhost
- **포트**: 3306
- **데이터베이스명**: groupware
- **사용자**: root
- **비밀번호**: qwer1234

### 3단계: 애플리케이션 빌드 및 실행

#### Gradle을 통한 빌드
```bash
# 전체 프로젝트 빌드
./gradlew clean build

# 테스트 없이 빌드
./gradlew build -x test
```

#### 애플리케이션 실행
```bash
# app-core 실행
./gradlew :app-core:bootRun

# 또는 JAR 파일 직접 실행
java -jar app-core/build/libs/app-core-0.0.1-SNAPSHOT.jar
```

### 4단계: 접속 확인
- **API Base URL**: http://localhost:8080/api/v1
- **Swagger UI**: http://localhost:8080/api/v1/swagger-ui.html
- **API Docs**: http://localhost:8080/api/v1/api-docs
- **Health Check**: http://localhost:8080/api/v1/actuator/health

## 프로젝트 구조

```
backend/
├── app-core/                    # 메인 애플리케이션 (Monorepo)
│   ├── src/
│   │   ├── main/
│   │   │   ├── java/
│   │   │   │   └── kr/co/platform/core/
│   │   │   │       ├── CoreApplication.java
│   │   │   │       ├── common/          # 공통 컴포넌트 (내장)
│   │   │   │       │   ├── config/      # 공통 설정
│   │   │   │       │   ├── dto/         # 공통 DTO
│   │   │   │       │   ├── entity/      # Base Entity
│   │   │   │       │   ├── exception/   # 예외 처리
│   │   │   │       │   └── util/        # 유틸리티
│   │   │   │       ├── config/          # 애플리케이션 설정
│   │   │   │       │   ├── SecurityConfig.java
│   │   │   │       │   ├── SwaggerConfig.java
│   │   │   │       │   └── WebConfig.java
│   │   │   │       └── domain/          # 비즈니스 도메인
│   │   │   │           └── schedule/    # 일정 관리 도메인
│   │   │   │               ├── mapper/
│   │   │   │               ├── model/
│   │   │   │               ├── service/
│   │   │   │               └── web/
│   │   │   └── resources/
│   │   │       ├── application.yml     # 애플리케이션 설정
│   │   │       ├── logback-spring.xml  # 로깅 설정
│   │   │       └── db/migration/       # Flyway 마이그레이션
│   │   └── test/
│   └── build.gradle
├── docker-compose/              # Docker 설정
│   └── db/
│       ├── docker-compose.yml
│       └── .env
├── docs/                        # 문서
├── gradle/                      # Gradle Wrapper
├── build.gradle                # 루트 빌드 설정
├── settings.gradle             # 프로젝트 설정
└── CLAUDE.md                   # AI 어시스턴트 가이드
```

## 환경 설정

### application.yml 주요 설정
```yaml
spring:
  application:
    name: app-core
    
  datasource:
    url: jdbc:mariadb://localhost:3306/groupware
    username: root
    password: qwer1234
    driver-class-name: org.mariadb.jdbc.Driver
    
server:
  port: 8080
  servlet:
    context-path: /api/v1
    
mybatis:
  mapper-locations: classpath:kr/co/platform/**/*.xml
  type-aliases-package: kr.co.platform.core.**.entity, kr.co.platform.core.**.dto
  
logging:
  level:
    kr.co.platform: DEBUG
    org.mybatis: DEBUG
```

### Docker Compose 환경 변수 (.env)
```properties
# MariaDB 설정
MYSQL_ROOT_PASSWORD=qwer1234
MYSQL_DATABASE=groupware
MYSQL_USER=platform
MYSQL_PASSWORD=qwer1234
DB_PORT=3306
TZ=Asia/Seoul
```

## 개발 도구 명령어

### Gradle 명령어
```bash
# 전체 빌드
./gradlew build

# 클린 빌드
./gradlew clean build

# 테스트 실행
./gradlew test

# 특정 모듈 실행
./gradlew :app-core:bootRun

# 의존성 확인
./gradlew dependencies
```

### Docker 명령어
```bash
# 컨테이너 시작
docker-compose -f docker-compose/db/docker-compose.yml up -d

# 컨테이너 중지
docker-compose -f docker-compose/db/docker-compose.yml down

# 컨테이너 및 볼륨 삭제
docker-compose -f docker-compose/db/docker-compose.yml down -v

# 데이터베이스 접속
docker exec -it groupware-mariadb mysql -uroot -pqwer1234

# 컨테이너 로그 확인
docker logs -f groupware-mariadb
```

### 데이터베이스 명령어
```sql
-- 데이터베이스 확인
SHOW DATABASES;

-- 테이블 확인
USE groupware;
SHOW TABLES;

-- 사용자 확인
SELECT user, host FROM mysql.user;
```

## 트러블슈팅

### 1. 포트 충돌
- **8080 포트 사용 중**:
  ```yaml
  # application.yml에서 포트 변경
  server:
    port: 8081
  ```

- **3306 포트 사용 중**:
  ```yaml
  # docker-compose.yml에서 포트 변경
  ports:
    - "3307:3306"
  ```

### 2. 데이터베이스 연결 실패
```bash
# Docker 상태 확인
docker ps

# 네트워크 확인
docker network ls

# 컨테이너 재시작
docker-compose -f docker-compose/db/docker-compose.yml restart
```

### 3. Gradle 빌드 실패
```bash
# Gradle 캐시 삭제
./gradlew clean
rm -rf ~/.gradle/caches/

# Gradle Daemon 중지
./gradlew --stop

# Wrapper 재생성
gradle wrapper --gradle-version=8.5
```

### 4. Spring Boot 실행 오류
```bash
# 로그 레벨 변경 (application.yml)
logging:
  level:
    root: DEBUG
    
# JVM 옵션 추가 실행
./gradlew :app-core:bootRun --debug
```

## IntelliJ IDEA 설정

### 1. 프로젝트 Import
- File → Open → backend 폴더 선택
- Gradle 프로젝트로 인식
- JDK 17 설정 확인

### 2. Lombok 설정
- Settings → Plugins → Lombok 설치
- Settings → Build → Compiler → Annotation Processors
- "Enable annotation processing" 체크

### 3. 실행 설정
- Run → Edit Configurations
- Spring Boot → CoreApplication
- Environment variables: `SPRING_PROFILES_ACTIVE=default`

## VS Code 설정

### 1. 필수 확장 설치
```json
{
  "recommendations": [
    "vscjava.vscode-java-pack",
    "pivotal.vscode-spring-boot",
    "vscjava.vscode-gradle",
    "vscjava.vscode-lombok"
  ]
}
```

### 2. launch.json 설정
```json
{
  "version": "0.2.0",
  "configurations": [
    {
      "type": "java",
      "name": "CoreApplication",
      "request": "launch",
      "mainClass": "kr.co.platform.core.CoreApplication",
      "projectName": "app-core"
    }
  ]
}
```

## 보안 주의사항

1. **개발 환경에서만 사용**: 현재 Security 설정이 비활성화되어 있음
2. **운영 환경 설정**: 반드시 JWT 인증 활성화
3. **데이터베이스 비밀번호**: 운영 환경에서는 강력한 비밀번호 사용
4. **CORS 설정**: 운영 환경에서는 특정 도메인만 허용

## 참고 문서

- [Spring Boot 공식 문서](https://spring.io/projects/spring-boot)
- [MyBatis Spring Boot Starter](https://mybatis.org/spring-boot-starter/)
- [SpringDoc OpenAPI](https://springdoc.org/)
- [Docker Compose 문서](https://docs.docker.com/compose/)